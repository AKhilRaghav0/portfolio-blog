<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Google Carousal Effect on iOS | Akhil Raghav</title>
<meta name="keywords" content="SwiftUI, iOS">
<meta name="description" content="Google Carousal Effect on iOS with a help of SwiftUI  and UIKit.">
<meta name="author" content="">
<link rel="canonical" href="//localhost:1313/posts/post-1/">
<link crossorigin="anonymous" href="../../assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="//localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="//localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="//localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="//localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="//localhost:1313/posts/post-1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="//localhost:1313/" accesskey="h" title="Akhil Raghav (Alt + H)">Akhil Raghav</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="//localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/about/about" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/about/resume" title="Resume">
                    <span>Resume</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Google Carousal Effect on iOS
    </h1>
    <div class="post-description">
      Google Carousal Effect on iOS with a help of SwiftUI  and UIKit.
    </div>
    <div class="post-meta"><span title='2024-01-31 14:07:29 +0000 UTC'>January 31, 2024</span>

</div>
  </header> 
  <div class="post-content"><p>Google has a really cool on-hover effect that you can see on the web if you were to search for stuff like popular movies or Disney movies. The layout is pretty simple with a horizontally scrolling scrollview component with items that consist of the movie poster and the movie title displayed beneath it.</p>
<!-- raw HTML omitted -->
<figure>
    <img loading="lazy" src="https://i.postimg.cc/LXr2k6hV/google-carousal-web.png"/> <figcaption>
            Google Carousal
        </figcaption>
</figure>

<p>What’s interesting is that if you were to hover over any item, it smoothly expands to reveal additional detail</p>
<figure>
    <img loading="lazy" src="https://i.postimg.cc/3Nvrz0z6/google-carousal-web-expand.gif"/> <figcaption>
            Expanded View of Google Carousel
        </figcaption>
</figure>

<p>The expanded item shows details such as the year of release, certification, runtime &amp; watch options etc. Notice that the expanded view displays a still from the movie that very nicely comes into view on hover and reverts to the movie poster when no longer hovering. Also if you were to hover over an item that is partially visible, it smoothly expands into view. Pretty neat !</p>
<p>To recreate this in SwiftUI we need to do the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>@State <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> selectedItem: CarouselItem?
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ScrollViewReader { proxy <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>    ScrollView(.horizontal) {
</span></span><span style="display:flex;"><span>        HStack(spacing: <span style="color:#ae81ff">20</span>) {
</span></span><span style="display:flex;"><span>            ForEach(items, id: <span style="color:#960050;background-color:#1e0010">\</span>.id) { item <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>                CarousalItemView(item: item, selectedItem: <span style="color:#960050;background-color:#1e0010">$</span>selectedItem)
</span></span><span style="display:flex;"><span>                    .frame(width: selectedItem?.id == item.id ? <span style="color:#ae81ff">250</span> : <span style="color:#ae81ff">150</span>, height: <span style="color:#ae81ff">250</span>)
</span></span><span style="display:flex;"><span>                    .clipShape(RoundedRectangle(cornerRadius: <span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>                    .contentShape(Rectangle())
</span></span><span style="display:flex;"><span>                    .id(item.id)
</span></span><span style="display:flex;"><span>                    .onTapGesture {
</span></span><span style="display:flex;"><span>                        DispatchQueue.main.async {
</span></span><span style="display:flex;"><span>                            withAnimation(.easeInOut(duration: <span style="color:#ae81ff">0.4</span>)) {
</span></span><span style="display:flex;"><span>                                selectedItem = selectedItem?.id == item.id ? <span style="color:#66d9ef">nil</span> : item
</span></span><span style="display:flex;"><span>                            }
</span></span><span style="display:flex;"><span>                        }
</span></span><span style="display:flex;"><span>                        DispatchQueue.main.asyncAfter(deadline: .now() <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.1</span>) {
</span></span><span style="display:flex;"><span>                            withAnimation(.easeInOut(duration: <span style="color:#ae81ff">0.4</span>)) {
</span></span><span style="display:flex;"><span>                                proxy.scrollTo(selectedItem?.id, anchor: .center)
</span></span><span style="display:flex;"><span>                            }
</span></span><span style="display:flex;"><span>                        }
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    .frame(height: <span style="color:#ae81ff">250</span>)
</span></span><span style="display:flex;"><span>    .scrollIndicators(.hidden)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Firstly, we need a <code>ScrollView</code> with an <code>HStack</code> of item views. Each item view has a fixed width unless it is the selected item i.e. tapped item instead of hovered; in which case it displays wider than other items in order to display more details.</p>
<p>We add a <code>onTapGesture</code> modifier to the view to set the selected item to the one we tapped on or set it to nil if it was previously selected. We do this inside the <code>withAnimation</code> function with duration of <code>0.4</code>. In case you’re wondering, I got this duration by inspecting the web carousal item properties in Chrome.</p>
<p>We then <code>scrollTo</code> the selected item with the anchor set to <code>center</code> using the <code>ScrollViewReader</code> proxy to bring the item into view if it is obscured in any way.</p>
<p>For the actual item view, the crux looks something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>@State <span style="color:#66d9ef">var</span> item: CarouselItem
</span></span><span style="display:flex;"><span>@Binding <span style="color:#66d9ef">var</span> selectedItem: CarouselItem?
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> expanded: Bool {
</span></span><span style="display:flex;"><span>    item.id == selectedItem?.id
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ZStack {
</span></span><span style="display:flex;"><span>    Image(item.posterImage)
</span></span><span style="display:flex;"><span>        .resizable()
</span></span><span style="display:flex;"><span>        .scaledToFill()
</span></span><span style="display:flex;"><span>        .scaleEffect(expanded ?  <span style="color:#ae81ff">1.5</span> : <span style="color:#ae81ff">1</span>, anchor: .topLeading)
</span></span><span style="display:flex;"><span>        .frame(width: expanded ? <span style="color:#ae81ff">250</span> : <span style="color:#ae81ff">150</span>, height: <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        .matchedGeometryEffect(id: <span style="color:#e6db74">&#34;image&#34;</span>, <span style="color:#66d9ef">in</span>: namespace, anchor: .topLeading, isSource: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>        .opacity(expanded ? <span style="color:#ae81ff">0</span> : <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    Image(item.stillImage)
</span></span><span style="display:flex;"><span>        .resizable()
</span></span><span style="display:flex;"><span>        .scaledToFill()
</span></span><span style="display:flex;"><span>        .frame(width: expanded ? <span style="color:#ae81ff">250</span> : <span style="color:#ae81ff">150</span>, height: <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        .matchedGeometryEffect(id: <span style="color:#e6db74">&#34;image&#34;</span>, <span style="color:#66d9ef">in</span>: namespace, anchor: .topLeading, isSource: <span style="color:#66d9ef">false</span>)
</span></span><span style="display:flex;"><span>        .opacity(expanded ? <span style="color:#ae81ff">1</span> : <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        .overlay(alignment: .leading) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> expanded {
</span></span><span style="display:flex;"><span>                itemDetailsView()
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Using a <code>ZStack</code> we place 2 <code>Image</code> views to display the poster image and the still image respectively. The poster image has a <code>scaleEffect</code> applied to it to scale-out when the item is tapped while affecting its <code>opacity modifier</code> as well. We do the same with the still image but without the scaleEffect since it just ‘appears’. Finally, we accomplish the image switching animation using the <code>matchedGeometryEffect</code> modifier to swap the poster with the still and vice versa.</p>
<p>The result looks something like this:</p>
<figure>
    <img loading="lazy" src="https://i.postimg.cc/zB9GWdYL/google-carousal-ios.gif"/> <figcaption>
            Google&#39;s carousel on iOS.
        </figcaption>
</figure>

<!-- raw HTML omitted -->
<!-- raw HTML omitted -->


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="//localhost:1313/tags/swiftui/">SwiftUI</a></li>
      <li><a href="//localhost:1313/tags/ios/">IOS</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>Akhil Raghav</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
